<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="renderer" content="webkit">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title></title>
		<script type="text/javascript">
			(function(w,d){
				function setREM() {
					var __h = d.documentElement, __b = d.body;
					__w = __h.clientWidth || __b.clientWidth;
					var __f = __w / 18.75;
					__h.style.fontSize = __f + 'px';
				}
				setREM()
				w.onresize = function() {
					setTimeout(function(){
						setREM()
					},100)
				}
			})(window, window.document)
		</script>
		<style type="text/css">
			@-ms-viewport {
				width: device-width;
			}
			
			@-o-viewport {
				width: device-width;
			}
			
			@viewport {
				width: device-width;
			}
		</style>
		<!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
		<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<!-- 可选的 Bootstrap 主题文件（一般不用引入） -->
		<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
		<script>
			// Copyright 2014-2015 Twitter, Inc.
			// Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
			if(navigator.userAgent.match(/IEMobile\/10\.0/)) {
				var msViewportStyle = document.createElement('style')
				msViewportStyle.appendChild(
					document.createTextNode(
						'@-ms-viewport{width:auto!important}'
					)
				)
				document.querySelector('head').appendChild(msViewportStyle)
			}
		</script>
		
		<link rel="stylesheet" href="../css/boot.css" />
		<link rel="stylesheet" href="../css/theme.css" />
		<link rel="stylesheet" href="../css/newtheme.css" />
	</head>

	<body class="hasNav hasFoot fullscreen">
		
		<div role="navigation" class="navbar-fixed-top">
			<div class="container-fluid">
				<div class="pull-left">
					<a role="backlink" class="glyphicon glyphicon-menu-left" href="javascript:history.go(-1);"></a>
				</div>
				<div class="pull-right">
					<a  href="javascript:void();"></a>
				</div>
				<div role="navtitle">
					我的处方
				</div>
			</div>
		</div>
		
		<div role="identification" class="identification">
		
			<div id="add-pres" >
				<div class="upload">
					<div class="big-icon">
						<img id="prev-image" src="../img/presci3.png"  />
					</div>
				</div>
				<div class="identification-tip text-center">
					 暂无处方
				</div>
			
			
			    <div class="identification-upload">
					<div class="fileUpload btn btn-warning  btn-lg btn-block upload-add">
					    <span>添加处方</span>
					</div>
				</div>
			</div>
			
			<div id="upload-pres"  class="hide">
				<div class="upload">
					<div class="upload-pic">
						<img   />
					</div>
				</div>
				
			
			    <div class="identification-upload">
					<div class="fileUpload btn btn-warning  btn-lg btn-block">
					    <span>上传</span>
					    <input type="file" class="upload upload-btn" />
					</div>
				</div>
			</div>
			
		
            <div id="verifying-pres" class="hide" >
				<div class="upload">
					<div class="mypres-icon">
						<img id="verify-image" src="../img/prescirp_03.png"  />
					</div>
					<div class="identification-tip text-center edit-text" style="font-size: 18px;font-weight: bolder;color: #fea70f;">
						 审核中
					</div>
				</div>
			
			    <div class="identification-upload">
					<div class="fileUpload btn btn-warning  btn-lg btn-block">
					    <span>再次上传</span>
					    <input type="file" class="upload upload-again" />
					</div>
				</div>
			</div>
			
		</div>
		
		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
		<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
		<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
		<!--<script src="../js/zepto.min.js"></script>-->
		<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
		
		<script>
			$(document).ready(function(){
				//使用JS-SDK的页面必须先注入配置信息
				/*var url = window.location.href;
				$.ajax({
			        type: "get",
			        url: "http://122.194.216.11/msklcms/wx/wxshare.xhtml", // 这个就是不同于当前域的一个URL地址，这里单纯演示，所以同域
			        dataType: "json",
			        data: "url="+encodeURIComponent(url), // jsonpcallback与上面的jsonp值一致
			        success: function (json) {
			        	var param = json.result;
			    		wx.config({
			    			debug : true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
			    			appId : param.appId, // 必填，公众号的唯一标识
			    			timestamp : param.timestamp, // 必填，生成签名的时间戳
			    			nonceStr : param.nonceStr, // 必填，生成签名的随机串
			    			signature : param.signature,// 必填，签名，见附录1
			    			jsApiList : [ 'chooseImage','previewImage','uploadImage',
						    			'onMenuShareTimeline', 'onMenuShareAppMessage',
						    			'onMenuShareQQ', 'onMenuShareWeibo','scanQRCode']
			    		// 必填，需要使用的JS接口列表，所有JS接口列表见附录2
			    		});
			    		wx.ready(function(){
			    			alert("ready");
			    		});
			    		wx.error(function(){
			    			alert("error");
			    		});
			        }
			    });*/
			    var param = {
			    	"timestamp": "1491916607",
					"appId": "wx4cd77656137c622b",
					"nonceStr": "c781c94d2c1747b194531e80a92dfeff",
					"signature": "2A18F0F0BDEF43C41F3810DE39B18B173C375917"
					};
			    wx.config({
	    			debug : true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
	    			appId : param.appId, // 必填，公众号的唯一标识
	    			timestamp : param.timestamp, // 必填，生成签名的时间戳
	    			nonceStr : param.nonceStr, // 必填，生成签名的随机串
	    			signature : param.signature,// 必填，签名，见附录1
	    			jsApiList : [ 'chooseImage','previewImage','uploadImage',
				    			'onMenuShareTimeline', 'onMenuShareAppMessage',
				    			'onMenuShareQQ', 'onMenuShareWeibo','scanQRCode']
	    		// 必填，需要使用的JS接口列表，所有JS接口列表见附录2
	    		});
				$('.upload-add').on("click", wxChooseImage);
			});
			
//			$(function(){
//				$("#add-btn").on("change",function(){
//					//has file
//					if(this.files && this.files[0])
//					{
//						var FR= new FileReader();    
//					    FR.addEventListener("load", function(e) {
//					      $("#prev-image").attr({src:e.target.result});
//					    }); 
//					    
//					    FR.readAsDataURL(this.files[0] );
//					}
//				});
//			});
//			
        //拍照或从手机相册中选图接口  
		function wxChooseImage() { 
			//console.log("123");
		    wx.chooseImage({  
				   count: 1,  
				   needResult: 1,  
				   sizeType: ['original', 'compressed'], // 可以指定是原图还是压缩图，默认二者都有  
			   	   sourceType: ['album', 'camera'], // 可以指定来源是相册还是相机，默认二者都有  
			       success: function (data) {  
				       localIds = data.localIds[0].toString(); // 返回选定照片的本地ID列表，localId可以作为img标签的src属性显示图片  
				       alert(localIds);
				       $("#prev-image").attr({src:localIds});
				   },  
			       fail: function (res) {  
			       alterShowMessage("操作提示", JSON.stringify(res), "1", "确定", "", "", "");  
			  }  
			  
			});  
		}  
		//上传图片接口  
        function wxuploadImage(e) {  
             
            wx.uploadImage({  
                localId: e, // 需要上传的图片的本地ID，由chooseImage接口获得  
                isShowProgressTips: 1, // 默认为1，显示进度提示  
                success: function (res) {  
                    mediaId = res.serverId; // 返回图片的服务器端ID  
                    if (rh.tostr(mediaId)) {  
                        $(".myimg").attr("src", localIds);  
                    }  
  
                },  
                fail: function (error) {  
                    picPath = '';  
                    localIds = '';  
                    alert(Json.stringify(error));  
  
                }  
  
            });  
        }  	
		</script>
	</body>

</html>